<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        .quarter-circle1{
            width:170px;
            height :170px;
            background-color: red;
            color: red;
            border-top-left-radius: 150px;
            position: absolute;
            top: 150px;
            left: 600px;
            box-shadow: 0 0 20px 5px red;
            animation: pulse 2s infinite;
            animation-delay: 0s;
        }
        .q1{
            width:170px;
            height :170px;
            background-color: red;
            color: red;
            border-top-left-radius: 150px;
            position: absolute;
            top: 150px;
            left: 600px;
            box-shadow: 0 0 20px 5px red;
        }
        .quarter-circle2{
            width:170px;
            height :170px;
            background-color: green;
            color:green;
            border-top-right-radius: 150px;
            position: absolute;
            top: 150px;
            left: 750px;
            box-shadow: 0 0 20px 5px green;
            animation: pulse 2s infinite;
            animation-delay: 0.5s;
        }
        .q2{
            width:170px;
            height :170px;
            background-color: green;
            color:green;
            border-top-right-radius: 150px;
            position: absolute;
            top: 150px;
            left: 750px;
            box-shadow: 0 0 20px 5px green;
        }
        
        .quarter-circle3{
            width:170px;
            height :170px;
            background-color:blue;
            color: blue;
            border-bottom-left-radius: 150px;
            position: absolute;
            top: 300px;
            left: 600px;box-shadow: 0 0 20px 5px ;
            box-shadow: 0 0 20px 5px blue;
            animation: pulse 2s infinite;
            animation-delay: 1s;
        }
        .qc3{
            width:170px;
            height :170px;
            background-color:blue;
            color: blue;
            border-bottom-left-radius: 150px;
            position: absolute;
            top: 300px;
            left: 600px;box-shadow: 0 0 20px 5px ;
            box-shadow: 0 0 20px 5px blue;
        }
        
        .quarter-circle4{
            width:170px;
            height :170px;
            background-color: yellow;
            color: yellow;
            border-bottom-right-radius: 150px;
            position: absolute;
            top: 300px;
            left: 750px;box-shadow: 0 0 20px 5px ;
            box-shadow: 0 0 20px 5px yellow;
            animation: pulse 2s infinite;
            animation-delay: 1.5s;
        }
        .qc4{
            width:170px;
            height :170px;
            background-color: yellow;
            color: yellow;
            border-bottom-right-radius: 150px;
            position: absolute;
            top: 300px;
            left: 750px;box-shadow: 0 0 20px 5px ;
            box-shadow: 0 0 20px 5px yellow;
        }
        @keyframes pulse {
            0%, 100%{
                box-shadow: 0 0 20px 5px currentColor;
                opacity: 1;
            }
            50%{
                box-shadow: 0 0 40px 20px currentColor;
                opacity :0.8;
            }
        }
        
        .simon1{
            color: aliceblue;
            width: 150px;
            height:150px;
            background-color: black;
            border-radius: 50%;
            position: absolute;
            top: 230px;
            left: 680px;
            font-family: 'Press Start 2P', monospace;
            font-size: 20px; /* Pixel fonts often look best at specific, larger sizes */
            color: #FFFFFF;
            border: none;
            outline: none;
            cursor: pointer;
        
        }
        .simon1::before {
            content: ' SIMON SAYS'; 
            color: aliceblue;
            }
        .simon1:hover {
             background-color: #FFFFFF; /* New background for the entire button */
            }
        .simon1:hover::before {
            content: 'START PLAYING'; 
            color: black;
}
        
        .simon2{
            font-family: 'Press Start 2P', monospace;
            font-size: 24px; /* Pixel fonts often look best at specific, larger sizes */
            color: #FFFFFF;
            width: 250px;
            height:80px;
            background-color: black;
            border-radius: 30px;
            position: absolute;
            top: 520px;
            left: 630px;
            padding: 10px 15px;
            border: none;
            outline: none;
            cursor: pointer;
        }
        .simon3{
            font-family: 'Press Start 2P', monospace;
            font-size: 20px; /* Pixel fonts often look best at specific, larger sizes */
            color: #FFFFFF;
            width: 250px;
            height:80px;
            border-radius: 30px;
            background-color: black;
            position: absolute;
            top: 610px;
            left: 630px;
            border: none;
            outline: none;
            cursor: pointer;
        }
        /* --- Classe pour le Flash (Ajout√©e par JS) --- */
        .active {
            opacity: 1;
            box-shadow: 0 0 60px 25px currentColor !important; /* Ombre tr√®s intense pour le flash */
            opacity: 0.8;
            animation: none !important; /* D√©sactive l'animation de pulsation par d√©faut */
            transition: box-shadow 0.05s; /* Rend le flash plus instantan√© */
        }
/* Ajoutez les styles d'affichage pour le bouton central dans la section jeu */
        #jeu .simon1 {
            display: flex; /* Permet d'aligner le statut du jeu */
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        section { display: none; text-align: center; padding: 50px; }
        #menu { display: block; }
        .btn{
            color: aliceblue;
            width: 150px;
            height:150px;
            background-color: black;
            border-radius: 50%;
            position: absolute;
            top: 230px;
            left: 680px;
            font-family: 'Press Start 2P', monospace;
            font-size: 20px; /* Pixel fonts often look best at specific, larger sizes */
            color: #FFFFFF;
            border: none;
            outline: none;
        }

        /* --- Style du Scoreboard --- */
        #best-score-display {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px; 
            color:white; /* Vert pour le contraste et le style r√©tro */
            position: absolute;
            top: 90px; /* Positionnement au-dessus du jeu/menu central */
            left: 620px; 
            width: 250px;
            text-align: center;
            padding: 10px;
            border: 2px solid white;
            background-color: #000;
            z-index: 5;
}
        #retour {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px; 
            color:white; /* Vert pour le contraste et le style r√©tro */
            position: absolute;
            top: 90px; /* Positionnement au-dessus du jeu/menu central */
            left: 630px; 
            width: 250px;
            text-align: center;
            padding: 10px;
            border: 2px solid white;
            background-color: #000;
            z-index: 5;
            cursor:pointer;


        }
        /* --- STYLE DE POSITIONNEMENT G√âN√âRAL --- */
        #rules {
            /* Maintient le conteneur actif */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100vh;
        }

/* --- STYLE DE LA BO√éTE DE R√àGLES --- */
        #rules-box-simple ,#param-box {
            position: absolute; 
            top: 200px;
            font-size: medium;
            left: 565px; /* Ajust√© pour centrer une bo√Æte plus petite */
            width: 350px; /* R√©duit la largeur */
            padding: 20px; 
            background-color: black;
            border: 2px solid white; 
            border-radius: 8px; 
            font-family: 'Press Start 2P', monospace;
            color: #DDDDDD; 
            text-align: left;
            box-shadow: 0 0 10px white;
        }

        #rules-box-simple p {
            font-size: 10px;
            line-height: 1.5;
            margin: 10px 0;
        }

        /* --- STYLE DU BOUTON DE RETOUR (similaire au bouton #retour du jeu) --- */
        #retour-rules {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px; 
            color: white; 
            position: absolute;
            top: 100px;
            left: 640px; 
            width: 250px;
            text-align: center;
            padding: 10px;
            border: 2px solid white;
            background-color: #000;
            z-index: 5;
            cursor: pointer;
        }
        #retour-rules { top: 100px; left: 640px; }
        .active {
            opacity: 1;
            box-shadow: 0 0 60px 25px currentColor !important;
            opacity: 0.8;
            animation: none !important;
            transition: box-shadow 0.05s;
        }
        
        #btn-game-center, #Center { /* Cibler les deux pour la s√©curit√© */
            display: flex;             /* Active Flexbox */
            flex-direction: column;    /* Empile les enfants (statusDisplay et roundInfo) verticalement */
            justify-content: center;   /* Centre verticalement dans le bouton */
            align-items: center;       /* Centre horizontalement dans le bouton */
            text-align: center;
            cursor: pointer;
        }
        #param {
        /* Style g√©n√©ral de section pour le centrage */
        display: flex;
        justify-content: center;
        align-items: flex-start;
        height: 100vh;
    }

    </style>
</head>
<body style="background-image: url(vector-black-future.jpg);">
    <section id="menu" >
        <div id="best-score-display">MEILLEUR SCORE: 0</div>
        <div class="quarter-circle1"></div>
        <div class="quarter-circle2"></div>
        <div class="quarter-circle3"></div>
        <div class="quarter-circle4"></div>
        <button onclick="showSection('jeu')" class="simon1"></button>
        <button onclick="showSection('rules')" class="simon2">REGLES</button>
        <button onclick="showSection('param')" class="simon3">PARAMETRES</button>
    </section>
    
    <section id="jeu">
<button id="retour" onclick="showSection('menu')">RETOUR AU MENU</button>

<button id="retour" onclick="gameOver(true); showSection('menu');">RETOUR AU MENU</button>    
        <div id="red-game" class="q1" data-color="red" onclick="handlePlayerClick('red')"></div>
        <div id="green-game" class="q2" data-color="green" onclick="handlePlayerClick('green')"></div>
        <div id="blue-game" class="qc3" data-color="blue" onclick="handlePlayerClick('blue')"></div>
        <div id="yellow-game" class="qc4" data-color="yellow" onclick="handlePlayerClick('yellow')"></div>
    
        <button class="btn" id="btn-game-center"></button>
    </section>
    
    <section id="rules">
        <button id="retour-rules" onclick="showSection('menu')">RETOUR AU MENU</button>

        <div id="rules-box-simple">
            <h2 style="font-size: 24px; color: yellow; text-align: center;">REGLES SIMON</h2>
            <hr style="border-color: white;">
            
            <p>
                <span style="color: #00FF00; font-weight: bold;">OBJECTIF :</span> R√©p√©tez la s√©quence de couleurs de Simon.
            </p>
            <p>
                <span style="color: #FF6600; font-weight: bold;">TOUR :</span> Simon ajoute une couleur √† chaque tour.
            </p>
            <p>
                <span style="color: red; font-weight: bold;">PERTE :</span> Une erreur met fin √† la partie. Le score est le nombre de couleurs r√©p√©t√©es.
            </p>
            
        </div>
    </section>
    
    
    <section id="param">
        <button id="retour-rules" onclick="showSection('menu')">RETOUR AU MENU</button>
        
        <div id="param-box">
            <h2 style="font-size: 20px; color: cyan; text-align: center;">AJUSTER LES PARAM√àTRES</h2>
            <hr style="border-color: white;">
            
            <label for="flashDurationInput">Dur√©e du Flash (Vitesse) : <span id="flashDurationValue">350</span> ms</label>
            <input type="range" id="flashDurationInput" min="100" max="600" value="350" step="50" 
                   oninput="updateParams('flashDuration', this.value)">
            <p style="text-align: center; margin-top: 5px;">(100 ms=Rapide /600 ms =Lent)</p>

            <label for="intervalInput">D√©lai entre Couleurs:<span id="intervalValue">550</span> ms</label>
            <input type="range" id="intervalInput" min="400" max="1000" value="550" step="50"
                   oninput="updateParams('interval', this.value)">
            <p style="text-align: center; margin-top: 5px;">(400 ms = S√©quence Rapide / 1000 ms = Lente)</p>
        </div>
    </section>
    
    <script >
        // --- VARIABLES GLOBALES DU JEU ---
const COLORS = ['red', 'green', 'blue', 'yellow'];

const gameSequence = [];
let playerSequence = [];
let round = 1;
let isPlayerTurn = false;
let gameActive = false;

// Constantes d'animation
let FLASH_DURATION = 350; // Dur√©e du flash lors de la d√©mo
let INTERVAL = 550;       // D√©lai entre le d√©but de deux flashes

// --- √âL√âMENTS DOM ---



const Center = document.getElementById('btn-game-center');
const audioMap = {
    'red': new Audio('do.mp3'),
    'green': new Audio('re.mp3'),
    'blue': new Audio('mi.mp3'),
    'yellow': new Audio('fa.mp3')
};
// Cr√©ation des √©l√©ments d'affichage de statut (similaire √† la version pr√©c√©dente pour un affichage centr√©)
let statusDisplay = document.createElement('span');
statusDisplay.id = 'game-status';
statusDisplay.style.fontSize = '14px';
statusDisplay.style.fontFamily = "'Press Start 2P', monospace"; // Assurez le style
statusDisplay.textContent = "SIMON SAYS";

let roundInfo = document.createElement('span');
roundInfo.id = 'round-info';
roundInfo.style.fontSize = '10px';
roundInfo.style.marginTop = '5px';
roundInfo.style.fontFamily = "'Press Start 2P', monospace"; // Assurez le style
roundInfo.textContent = "Tour 0";

// Remplacer le contenu du bouton central par les affichages du statut
if (Center) {
    Center.innerHTML = '';
    Center.appendChild(statusDisplay);
    Center.appendChild(roundInfo);
}

// Map des √©l√©ments du jeu (utilisant les IDs ajout√©s au HTML)
const allQuadrants = {
    'red': document.getElementById('red-game'),
    'green': document.getElementById('green-game'),
    'blue': document.getElementById('blue-game'),
    'yellow': document.getElementById('yellow-game')
};

// --- FONCTIONS DE NAVIGATION ---

function showSection(id) {
    document.querySelectorAll('section').forEach(section => {
        section.style.display = 'none';
    });
    const targetSection = document.getElementById(id);
    if (targetSection) {
        targetSection.style.display = 'block';
    }
    
    // D√©marre le jeu si on entre dans la section 'jeu'
    if (id === 'menu') {
        displayBestScore();
    }
    else if (id === 'jeu') {
        startGame();
        } else if (id === 'param') {
        syncParamSliders(); // Synchroniser lors de l'ouverture des param√®tres
    
}
}
function updateParams(paramName, value) {
    const numericValue = parseInt(value, 10);
    
    if (paramName === 'flashDuration') {
        FLASH_DURATION = numericValue;
        document.getElementById('flashDurationValue').textContent = numericValue;
    } else if (paramName === 'interval') {
        INTERVAL = numericValue;
        document.getElementById('intervalValue').textContent = numericValue;
    }
}
function syncParamSliders() {
    // Cela garantit que lorsque l'utilisateur acc√®de aux param√®tres, les sliders
    // correspondent aux valeurs actuellement utilis√©es.
    const flashInput = document.getElementById('flashDurationInput');
    const intervalInput = document.getElementById('intervalInput');
    
    if (flashInput) {
        flashInput.value = FLASH_DURATION;
        document.getElementById('flashDurationValue').textContent = FLASH_DURATION;
    }
    if (intervalInput) {
        intervalInput.value = INTERVAL;
        document.getElementById('intervalValue').textContent = INTERVAL;
    }
}


// --- LOGIQUE D'ANIMATION ET DE JEU ---

/** Fait clignoter un quadrant sp√©cifique. */
function flashColor(colorId, duration) {
    const element = allQuadrants[colorId];
    const audio = audioMap[colorId];
    if (audio) {
        // Optionnel : R√©initialiser et jouer pour √©viter les d√©lais si le son est rejou√© rapidement
        audio.currentTime = 0; 
        audio.play().catch(e => console.error("Erreur lecture audio:", e)); // Utiliser catch pour √©viter les erreurs de lecture automatique non initi√©e par l'utilisateur
    }
    if (element) {
        element.classList.add('active'); 
        setTimeout(() => {
            element.classList.remove('active');
        }, duration); 
    }
}

/** D√©sactive l'animation de pulsation CSS infinie au d√©but du jeu. */
function disablePulseAnimation() {
    Object.values(allQuadrants).forEach(element => {
        if (element) {
            element.style.animation = 'none'; // D√©sactive l'animation
            element.style.boxShadow = element.style.boxShadow.replace('20px 5px', '10px 3px'); // Fixe une ombre plus discr√®te
        }
    });
}

/** Affiche la s√©quence de couleurs au joueur. */
function showSequence(sequence) {
    isPlayerTurn = false; 
    statusDisplay.textContent = "WATCH!";

    let delay = 0;

    sequence.forEach((colorId, index) => {
        setTimeout(() => {
            flashColor(colorId, FLASH_DURATION);
            
            if (index === sequence.length - 1) {
                setTimeout(startPlayerTurn, INTERVAL); // Commencer le tour du joueur apr√®s le dernier flash
            }
        }, delay);
        
        delay += INTERVAL;
    });
}

/** D√©marre le tour du joueur. */
function startPlayerTurn() {
    isPlayerTurn = true;
    statusDisplay.textContent = 'Votre tour!';
    const requiredClicks = gameSequence.length;
    let clickWord = (requiredClicks > 1) ? 'Clicks' : 'Click'; 
    
    // Mise √† jour de l'affichage
    roundInfo.textContent = ` R√©petez  ${requiredClicks} ${clickWord}`;
}

/** G√®re le clic du joueur sur un quadrant. */
window.handlePlayerClick = function(clickedColor) {
    if (!isPlayerTurn || !gameActive) return;

    flashColor(clickedColor, 150); // Flash court lors du clic
    playerSequence.push(clickedColor);
    
    checkPlayerInput();
}

/** V√©rifie si la s√©quence du joueur correspond. */
function checkPlayerInput() {
    const lastIndex = playerSequence.length - 1;
    
    if (playerSequence[lastIndex] !== gameSequence[lastIndex]) {
        gameOver(false); // S√©quence incorrecte
        return;
    }

    if (playerSequence.length === gameSequence.length) {
        // SUCC√àS : Le joueur a r√©ussi le tour
        statusDisplay.textContent = 'BIEN!';
        isPlayerTurn = false;
        roundInfo.textContent='';
        round++; // Incr√©menter le round
        
        setTimeout(nextRound, 1500); // Lancer le prochain tour
    }
}

/** Pr√©pare et d√©marre le tour suivant (incr√©mentation de la s√©quence). */
function nextRound() {
    if (!gameActive) return;

    playerSequence.length = 0;
    
    roundInfo.textContent = ` Tour ${round} `;
    
    // AJOUT: Nouvelle couleur pour rendre la s√©quence croissante
    const nextColor = COLORS[Math.floor(Math.random() * COLORS.length)];
    gameSequence.push(nextColor);
    
    showSequence(gameSequence);
}

/** Initialise et commence le jeu. */
function startGame() {
    gameActive = true;
    round = 1; 
    gameSequence.length = 0;
    playerSequence.length = 0;
    
    disablePulseAnimation(); 
    setTimeout(nextRound, 1000);
}
// --- VARIABLES GLOBALES DU JEU ---
// ... (vos variables existantes) ...
const LOCAL_STORAGE_KEY = 'simonSaysBestScore'; // Cl√© pour localStorage

// --- NOUVELLES FONCTIONS DE GESTION DU SCORE ---

/**
 * R√©cup√®re le meilleur score local stock√©.
 * @returns {number} Le meilleur score ou 0 si aucun score n'est trouv√©.
 */
function getBestScore() {
    const score = localStorage.getItem(LOCAL_STORAGE_KEY);
    return score ? parseInt(score, 10) : 0;
}

/**
 * Met √† jour le meilleur score local si le score actuel est sup√©rieur.
 * @param {number} newScore Le score que le joueur vient d'atteindre (round - 1).
 */
function updateBestScore(newScore) {
    const currentBest = getBestScore();
    if (newScore > currentBest) {
        localStorage.setItem(LOCAL_STORAGE_KEY, newScore.toString());
        return true; // Nouveau record
    }
    return false; // Pas de nouveau record
}

/**
 * Met √† jour l'affichage du meilleur score dans le menu.
 */
function displayBestScore() {
    const bestScoreElement = document.getElementById('best-score-display');
    const bestScore = getBestScore();
    if (bestScoreElement) {
        bestScoreElement.textContent = `Best Score: ${bestScore}`;
    }
}
/** Fin de la partie. */
/** Fin de la partie. */
function gameOver(isQuit) {
    gameActive = false;
    isPlayerTurn = false;
    
    // Le score est le round pr√©c√©dent
    const finalScore = round - 1; 

    if (!isQuit) {
         statusDisplay.textContent = 'Game Over! \n';
         roundInfo.textContent = `Score: ${finalScore}`;

         // V√©rifier et mettre √† jour le meilleur score
         const isNewRecord = updateBestScore(finalScore);

         let alertMessage = `Game Over! Score: ${finalScore}.`;
         if (isNewRecord) {
             alertMessage += "\nNOUVEAU SCORE LOCAL ! üèÜ";
         }
         
         setTimeout(() => {
             alert(alertMessage);
             showSection('menu');
             // S'assurer que le menu affiche le nouveau record
             displayBestScore(); 
         }, 100);
    }
    // Si on quitte le jeu manuellement, on met √† jour le menu pour l'affichage
    if (isQuit) {
        gameSequence.length = 0;
        playerSequence.length = 0;
        round = 1;
        statusDisplay.textContent = "SIMON SAYS";
        roundInfo.textContent = "Tour 0";

        // Nettoyer les s√©quences pour un nouveau d√©part (bien que startGame le fasse aussi)
        
        displayBestScore();
    }
}

// Ex√©cut√© au chargement : Initialisation de la section
showSection('menu');

    </script>


</body>
</html>